<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Cuestionario Inicial GMM ‚Äî Christian GarBa</title>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap" rel="stylesheet">
<style>
  :root{
    --brand:#0B5ED7;
    --brand-dark:#0842a0;
    --ink:#0f172a;
    --muted:#64748b;
    --panel:#f3f4f6;
    --line:#e2e8f0;
    --danger:#b91c1c;
    --wa:#25D366;
  }
  *{box-sizing:border-box}
  html,body{margin:0;padding:0;font-family:'Inter',system-ui,-apple-system,'Segoe UI',Roboto,Arial,sans-serif;background:#e5e7eb;color:var(--ink)}
  body{min-height:100vh;}
  a{text-decoration:none;color:inherit}

  .page{max-width:1040px;margin:0 auto;padding:20px 16px 40px;}

  /* Header */
  .header{
    display:flex;align-items:center;gap:16px;
    background:#ffffff;border-radius:16px;
    padding:14px 18px;
    border:1px solid var(--line);
    box-shadow:0 8px 24px rgba(15,23,42,.08);
    margin-bottom:18px;
  }
  .header-logo img{height:54px;width:auto;display:block;}
  .header-text-title{font-weight:800;font-size:20px;color:var(--ink);}
  .header-text-sub{font-size:13px;color:var(--muted);}
  .header-meta{margin-left:auto;font-size:13px;color:#0f172a;text-align:right;display:flex;flex-direction:column;gap:2px;}
  .header-meta span{white-space:nowrap;}

  /* Toolbar */
  .toolbar-top{
    display:flex;justify-content:flex-end;gap:10px;margin-bottom:10px;
  }
  .btn{
    appearance:none;border-radius:999px;
    border:1px solid var(--line);
    padding:9px 14px;
    background:#ffffff;
    font-size:13px;font-weight:600;
    cursor:pointer;transition:.18s ease;
    display:inline-flex;align-items:center;gap:6px;
  }
  .btn:hover{box-shadow:0 4px 14px rgba(15,23,42,.12);transform:translateY(-1px);}
  .btn-primary{background:var(--brand);border-color:var(--brand);color:#ffffff;}
  .btn-primary:hover{background:var(--brand-dark);}
  .btn-ghost{background:transparent;}

  /* Intro / Alert */
  .intro{
    background:#f8fafc;
    border-radius:14px;
    border:1px solid var(--line);
    padding:14px 16px;
    font-size:13px;
    margin-bottom:14px;
  }
  .intro-strong{font-weight:700;}
  .intro-note{color:var(--muted);margin-top:6px;font-size:12px;}

  /* Stepper */
  .stepper{
    display:flex;flex-wrap:wrap;gap:8px;margin-bottom:14px;
    font-size:12px;
  }
  .step-pill{
    display:flex;align-items:center;gap:6px;
    padding:6px 10px;border-radius:999px;
    border:1px solid var(--line);background:#f9fafb;color:var(--muted);
  }
  .step-pill.active{border-color:var(--brand);background:#eff6ff;color:#1d4ed8;font-weight:600;}
  .step-pill-num{
    width:18px;height:18px;border-radius:999px;
    display:flex;align-items:center;justify-content:center;
    font-size:11px;
    background:#e5e7eb;color:#1f2933;
  }
  .step-pill.active .step-pill-num{background:var(--brand);color:#fff;}

  /* Cards */
  .card{
    background:#ffffff;
    border-radius:16px;
    border:1px solid var(--line);
    padding:18px 18px 16px;
    margin-bottom:14px;
  }
  .card h2{
    margin:0 0 6px;
    font-size:18px;
    font-weight:800;
    display:flex;
    justify-content:space-between;
    align-items:center;
  }
  .card-sub{
    margin:0 0 12px;
    font-size:13px;
    color:var(--muted);
  }

  .grid{
    display:grid;
    grid-template-columns:repeat(auto-fit,minmax(220px,1fr));
    gap:12px 14px;
  }
  .field-group{
    display:flex;flex-direction:column;
  }
  label{
    font-size:12px;
    font-weight:600;
    color:#0f172a;
    margin-bottom:4px;
  }
  .required-mark{color:#b91c1c;margin-left:2px;}
  input[type="text"],
  input[type="email"],
  input[type="tel"],
  input[type="number"],
  input[type="date"],
  select,
  textarea{
    font-family:inherit;
    border-radius:10px;
    border:1px solid var(--line);
    padding:9px 10px;
    font-size:14px;
    background:#f9fafb;
    transition:border-color .15s, box-shadow .15s, background .15s;
  }
  textarea{min-height:72px;resize:vertical;}
  input:focus,select:focus,textarea:focus{
    outline:none;
    border-color:var(--brand);
    box-shadow:0 0 0 2px rgba(37,99,235,.18);
    background:#ffffff;
  }
  .field-help{font-size:11px;color:var(--muted);margin-top:3px;}

  /* Radios / checkboxes inline */
  .inline-options{display:flex;flex-wrap:wrap;gap:8px;}
  .chip{
    display:inline-flex;align-items:center;gap:6px;
    padding:6px 10px;border-radius:999px;
    border:1px solid var(--line);
    background:#f9fafb;
    font-size:12px;
    cursor:pointer;
  }
  .chip input{display:none;}
  .chip.active{border-color:var(--brand);background:#eff6ff;color:#1d4ed8;font-weight:600;}

  /* Dependientes */
  .dependientes-toggle-wrap{
    margin-top:10px;margin-bottom:4px;
    display:flex;flex-wrap:wrap;gap:8px;align-items:center;
  }
  .dependientes-section{
    margin-top:10px;
    border-top:1px dashed var(--line);
    padding-top:10px;
  }
  .dependiente-card{
    border-radius:12px;
    border:1px solid var(--line);
    padding:10px 12px;
    margin-top:8px;
    background:#f9fafb;
  }
  .dependiente-title{
    font-size:13px;font-weight:700;color:#0f172a;
    margin-bottom:6px;
  }

  /* Errors */
  .field-error{
    display:none;
    font-size:11px;
    color:var(--danger);
    margin-top:3px;
  }
  .has-error input,
  .has-error select,
  .has-error textarea{
    border-color:var(--danger) !important;
    box-shadow:0 0 0 1px rgba(185,28,28,.25);
    background:#fef2f2;
  }
  .has-error .field-error{display:block;}

  .form-error-summary{
    display:none;
    margin-bottom:10px;
    padding:10px 12px;
    background:#fef2f2;
    border-radius:10px;
    border:1px solid #fecaca;
    color:#7f1d1d;
    font-size:12px;
  }

  /* Footer / CTA */
  .form-footer{
    margin-top:10px;
    display:flex;
    flex-wrap:wrap;
    gap:10px;
    justify-content:flex-end;
    align-items:center;
  }
  .privacy-hint{
    font-size:11px;color:var(--muted);
    margin-top:4px;
  }

  /* WhatsApp floating */
  .wa-fab{
    position:fixed;
    right:16px;
    bottom:20px;
    background:var(--wa);
    color:#06371a;
    border-radius:999px;
    padding:10px 14px;
    font-size:13px;
    font-weight:700;
    box-shadow:0 10px 24px rgba(0,0,0,.25);
    display:flex;align-items:center;gap:6px;
    z-index:20;
  }

  /* Print */
  @media print{
    body{background:#ffffff;color:#000000;}
    .toolbar-top,.wa-fab{display:none!important;}
    .page{max-width:100%;padding:0 0 0;}
    .header{box-shadow:none;border-color:#cbd5e1;border-radius:0;}
    .card{box-shadow:none;border-color:#cbd5e1;border-radius:0;page-break-inside:avoid;}
    .stepper{display:none!important;}
  }

  /* Mobile tweaks */
  @media (max-width:640px){
    .header{align-items:flex-start;}
    .header-meta{font-size:12px;align-items:flex-end;}
  }
</style>
</head>
<body>
<div class="page">

  <!-- Toolbar -->
  <div class="toolbar-top">
    <button type="button" class="btn" onclick="window.print()">Descargar PDF</button>
  </div>

  <!-- Header -->
  <header class="header">
    <div class="header-logo">
      <!-- Usa el mismo logo que en tus otras herramientas -->
      <img src="./logo-garba.png" alt="Christian GarBa - Seguros con Estrategia">
    </div>
    <div>
      <div class="header-text-title">Cuestionario Inicial de Salud ¬∑ GMM</div>
      <div class="header-text-sub">Informaci√≥n para cotizar tu Seguro de Gastos M√©dicos Mayores</div>
    </div>
    <div class="header-meta">
      <span>üìû 662 417 6032</span>
      <span>‚úâÔ∏è christian.garcia@sfgarba.com.mx</span>
      <span>Christian GarBa ¬∑ Seguros con Estrategia</span>
    </div>
  </header>

  <!-- Intro -->
  <section class="intro">
    <div class="intro-strong">
      Antes de cotizar, necesito entender un poco de tu salud y la de tu familia.
    </div>
    <div class="intro-note">
      La informaci√≥n que compartas se usa √∫nicamente para evaluar opciones de seguro y, en su momento, para la contrataci√≥n.
      <br>Entre m√°s clara y completa sea, m√°s s√≥lido ser√° el respaldo de tu p√≥liza cuando la necesites.
    </div>
  </section>

  <!-- Stepper -->
  <div class="stepper" id="stepper">
    <div class="step-pill active" data-step="1">
      <div class="step-pill-num">1</div><span>Titular</span>
    </div>
    <div class="step-pill" data-step="2">
      <div class="step-pill-num">2</div><span>Familia</span>
    </div>
    <div class="step-pill" data-step="3">
      <div class="step-pill-num">3</div><span>Salud y antecedentes</span>
    </div>
    <div class="step-pill" data-step="4">
      <div class="step-pill-num">4</div><span>Confirmaci√≥n y env√≠o</span>
    </div>
  </div>

  <div id="formErrorSummary" class="form-error-summary">
    Revisa los campos marcados en rojo antes de continuar o enviar.
  </div>

  <!-- Secci√≥n 1: Titular -->
  <section class="card" data-step-pane="1">
    <h2>1. Datos del titular</h2>
    <p class="card-sub">
      El titular debe ser mayor de 18 a√±os. Si el seguro es solo para tus hijos, t√∫ sigues siendo la persona titular.
    </p>

    <div class="grid">
      <div class="field-group" data-field="titular_nombre">
        <label>Nombre(s) <span class="required-mark">*</span></label>
        <input type="text" id="titularNombre" class="required" data-label="Nombre del titular" autocomplete="name">
        <div class="field-error">Escribe el nombre del titular.</div>
      </div>
      <div class="field-group" data-field="titular_apellidos">
        <label>Apellidos <span class="required-mark">*</span></label>
        <input type="text" id="titularApellidos" class="required" data-label="Apellidos del titular" autocomplete="family-name">
        <div class="field-error">Escribe los apellidos del titular.</div>
      </div>
      <div class="field-group" data-field="titular_rfc">
        <label>RFC (persona f√≠sica)</label>
        <input type="text" id="titularRFC" placeholder="Ej. GABC800619XXX" data-label="RFC del titular" maxlength="13" autocomplete="off">
        <div class="field-help">Si lo capturas con formato correcto, intentar√© sugerir la fecha de nacimiento.</div>
        <div class="field-error">Revisa el formato del RFC.</div>
      </div>
      <div class="field-group" data-field="titular_fecha">
        <label>Fecha de nacimiento <span class="required-mark">*</span></label>
        <input type="date" id="titularFecha" class="required" data-label="Fecha de nacimiento del titular">
        <div class="field-help">El titular debe tener al menos 18 a√±os.</div>
        <div class="field-error">Indica una fecha de nacimiento v√°lida (mayor de 18 a√±os).</div>
      </div>
      <div class="field-group" data-field="titular_edad">
        <label>Edad (se calcula autom√°ticamente)</label>
        <input type="number" id="titularEdad" readonly>
        <div class="field-help">C√°lculo estimado con base en la fecha de nacimiento.</div>
      </div>
      <div class="field-group" data-field="titular_sexo">
        <label>Sexo biol√≥gico <span class="required-mark">*</span></label>
        <div class="inline-options" id="sexoTitularGroup">
          <label class="chip"><input type="radio" name="titularSexo" value="M"> <span>Hombre</span></label>
          <label class="chip"><input type="radio" name="titularSexo" value="F"> <span>Mujer</span></label>
        </div>
        <div class="field-error">Selecciona una opci√≥n.</div>
      </div>
      <div class="field-group" data-field="titular_estatura">
        <label>Estatura (cm) <span class="required-mark">*</span></label>
        <input type="number" id="titularEstatura" class="required" data-label="Estatura del titular" min="100" max="230">
        <div class="field-error">Indica una estatura en cent√≠metros.</div>
      </div>
      <div class="field-group" data-field="titular_peso">
        <label>Peso (kg) <span class="required-mark">*</span></label>
        <input type="number" id="titularPeso" class="required" data-label="Peso del titular" min="30" max="250" step="0.1">
        <div class="field-error">Indica un peso en kilogramos.</div>
      </div>

      <div class="field-group" data-field="titular_ocupacion">
        <label>Ocupaci√≥n / actividad principal <span class="required-mark">*</span></label>
        <input type="text" id="titularOcupacion" class="required" data-label="Ocupaci√≥n del titular">
        <div class="field-error">Escribe tu ocupaci√≥n o actividad principal.</div>
      </div>
      <div class="field-group" data-field="titular_telefono">
        <label>Tel√©fono m√≥vil <span class="required-mark">*</span></label>
        <input type="tel" id="titularTelefono" class="required" data-label="Tel√©fono del titular" placeholder="10 d√≠gitos" maxlength="15">
        <div class="field-error">Indica un n√∫mero de tel√©fono v√°lido.</div>
      </div>
      <div class="field-group" data-field="titular_email">
        <label>Correo electr√≥nico <span class="required-mark">*</span></label>
        <input type="email" id="titularEmail" class="required" data-label="Correo del titular">
        <div class="field-error">Indica un correo electr√≥nico v√°lido.</div>
      </div>
      <div class="field-group" data-field="titular_ciudad">
        <label>Ciudad y estado <span class="required-mark">*</span></label>
        <input type="text" id="titularCiudad" class="required" data-label="Ciudad y estado">
        <div class="field-error">Indica ciudad y estado.</div>
      </div>
    </div>
  </section>

  <!-- Secci√≥n 2: Familia -->
  <section class="card" data-step-pane="2" style="display:none;">
    <h2>2. Personas a asegurar</h2>
    <p class="card-sub">
      Indica si el seguro ser√≠a solo para ti o tambi√©n para tu familia. Si agregas familiares, capturamos datos b√°sicos de cada uno.
    </p>

    <div class="field-group" data-field="cobertura_tipo">
      <label>¬øA qui√©nes te gustar√≠a asegurar? <span class="required-mark">*</span></label>
      <div class="inline-options" id="coberturaTipoGroup">
        <label class="chip"><input type="radio" name="coberturaTipo" value="solo"> <span>Solo yo</span></label>
        <label class="chip"><input type="radio" name="coberturaTipo" value="familia"> <span>Yo y mi familia</span></label>
      </div>
      <div class="field-error">Selecciona una opci√≥n.</div>
    </div>

    <div class="dependientes-toggle-wrap" id="dependientesConfig" style="display:none;">
      <div class="field-group" style="min-width:220px;" data-field="num_dependientes">
        <label>N√∫mero de adicionales (familiares)</label>
        <select id="numDependientes">
          <option value="0">Ninguno adicional</option>
          <option value="1">1 adicional</option>
          <option value="2">2 adicionales</option>
          <option value="3">3 adicionales</option>
          <option value="4">4 adicionales</option>
          <option value="5">5 adicionales</option>
        </select>
        <div class="field-help">Ej. esposo(a), hijos, padres, etc.</div>
      </div>
      <div class="field-group">
        <label>Relaciones t√≠picas</label>
        <div class="field-help">
          Puedes usar: Esposo(a), Hijo(a), Padre, Madre, Pareja, etc.
        </div>
      </div>
    </div>

    <div class="dependientes-section" id="dependientesSection" style="display:none;">
      <!-- Dependiente 1-5 -->
      <div class="dependiente-card" data-index="1">
        <div class="dependiente-title">Adicional 1</div>
        <div class="grid">
          <div class="field-group" data-field="dep1_nombre">
            <label>Nombre completo del adicional 1</label>
            <input type="text" id="dep1Nombre" data-label="Nombre adicional 1">
          </div>
          <div class="field-group" data-field="dep1_relacion">
            <label>Relaci√≥n</label>
            <input type="text" id="dep1Relacion" placeholder="Ej. Esposo(a), Hijo(a)">
          </div>
          <div class="field-group" data-field="dep1_fecha">
            <label>Fecha de nacimiento</label>
            <input type="date" id="dep1Fecha">
          </div>
          <div class="field-group" data-field="dep1_edad">
            <label>Edad (autom√°tica)</label>
            <input type="number" id="dep1Edad" readonly>
          </div>
          <div class="field-group" data-field="dep1_sexo">
            <label>Sexo biol√≥gico</label>
            <div class="inline-options" id="dep1SexoGroup">
              <label class="chip"><input type="radio" name="dep1Sexo" value="M"> <span>Hombre</span></label>
              <label class="chip"><input type="radio" name="dep1Sexo" value="F"> <span>Mujer</span></label>
            </div>
          </div>
        </div>
      </div>

      <div class="dependiente-card" data-index="2" style="display:none;">
        <div class="dependiente-title">Adicional 2</div>
        <div class="grid">
          <div class="field-group">
            <label>Nombre completo del adicional 2</label>
            <input type="text" id="dep2Nombre">
          </div>
          <div class="field-group">
            <label>Relaci√≥n</label>
            <input type="text" id="dep2Relacion">
          </div>
          <div class="field-group">
            <label>Fecha de nacimiento</label>
            <input type="date" id="dep2Fecha">
          </div>
          <div class="field-group">
            <label>Edad (autom√°tica)</label>
            <input type="number" id="dep2Edad" readonly>
          </div>
          <div class="field-group">
            <label>Sexo biol√≥gico</label>
            <div class="inline-options" id="dep2SexoGroup">
              <label class="chip"><input type="radio" name="dep2Sexo" value="M"> <span>Hombre</span></label>
              <label class="chip"><input type="radio" name="dep2Sexo" value="F"> <span>Mujer</span></label>
            </div>
          </div>
        </div>
      </div>

      <div class="dependiente-card" data-index="3" style="display:none;">
        <div class="dependiente-title">Adicional 3</div>
        <div class="grid">
          <div class="field-group">
            <label>Nombre completo del adicional 3</label>
            <input type="text" id="dep3Nombre">
          </div>
          <div class="field-group">
            <label>Relaci√≥n</label>
            <input type="text" id="dep3Relacion">
          </div>
          <div class="field-group">
            <label>Fecha de nacimiento</label>
            <input type="date" id="dep3Fecha">
          </div>
          <div class="field-group">
            <label>Edad (autom√°tica)</label>
            <input type="number" id="dep3Edad" readonly>
          </div>
          <div class="field-group">
            <label>Sexo biol√≥gico</label>
            <div class="inline-options" id="dep3SexoGroup">
              <label class="chip"><input type="radio" name="dep3Sexo" value="M"> <span>Hombre</span></label>
              <label class="chip"><input type="radio" name="dep3Sexo" value="F"> <span>Mujer</span></label>
            </div>
          </div>
        </div>
      </div>

      <div class="dependiente-card" data-index="4" style="display:none;">
        <div class="dependiente-title">Adicional 4</div>
        <div class="grid">
          <div class="field-group">
            <label>Nombre completo del adicional 4</label>
            <input type="text" id="dep4Nombre">
          </div>
          <div class="field-group">
            <label>Relaci√≥n</label>
            <input type="text" id="dep4Relacion">
          </div>
          <div class="field-group">
            <label>Fecha de nacimiento</label>
            <input type="date" id="dep4Fecha">
          </div>
          <div class="field-group">
            <label>Edad (autom√°tica)</label>
            <input type="number" id="dep4Edad" readonly>
          </div>
          <div class="field-group">
            <label>Sexo biol√≥gico</label>
            <div class="inline-options" id="dep4SexoGroup">
              <label class="chip"><input type="radio" name="dep4Sexo" value="M"> <span>Hombre</span></label>
              <label class="chip"><input type="radio" name="dep4Sexo" value="F"> <span>Mujer</span></label>
            </div>
          </div>
        </div>
      </div>

      <div class="dependiente-card" data-index="5" style="display:none;">
        <div class="dependiente-title">Adicional 5</div>
        <div class="grid">
          <div class="field-group">
            <label>Nombre completo del adicional 5</label>
            <input type="text" id="dep5Nombre">
          </div>
          <div class="field-group">
            <label>Relaci√≥n</label>
            <input type="text" id="dep5Relacion">
          </div>
          <div class="field-group">
            <label>Fecha de nacimiento</label>
            <input type="date" id="dep5Fecha">
          </div>
          <div class="field-group">
            <label>Edad (autom√°tica)</label>
            <input type="number" id="dep5Edad" readonly>
          </div>
          <div class="field-group">
            <label>Sexo biol√≥gico</label>
            <div class="inline-options" id="dep5SexoGroup">
              <label class="chip"><input type="radio" name="dep5Sexo" value="M"> <span>Hombre</span></label>
              <label class="chip"><input type="radio" name="dep5Sexo" value="F"> <span>Mujer</span></label>
            </div>
          </div>
        </div>
      </div>

    </div>
  </section>

  <!-- Secci√≥n 3: Salud -->
  <section class="card" data-step-pane="3" style="display:none;">
    <h2>3. Salud y antecedentes m√©dicos</h2>
    <p class="card-sub">
      Esta secci√≥n resume de forma general tu estado de salud y el de los asegurados.
      Si en alguna respuesta tienes duda, es mejor comentarlo brevemente.
    </p>

    <!-- Tabaquismo -->
    <div class="field-group" data-field="tabaco">
      <label>¬øFumas o has fumado tabaco?</label>
      <div class="inline-options" id="tabacoGroup">
        <label class="chip"><input type="radio" name="tabaco" value="nunca"> <span>Nunca he fumado</span></label>
        <label class="chip"><input type="radio" name="tabaco" value="actual"> <span>Actualmente fumo</span></label>
        <label class="chip"><input type="radio" name="tabaco" value="ex"> <span>Fum√© antes pero ya no</span></label>
      </div>
      <div class="field-help">
        En muchos cuestionarios se pregunta desde cu√°ndo fumas o desde cu√°ndo dejaste de fumar.
      </div>
    </div>

    <div id="tabacoDetalleActual" class="grid" style="display:none;margin-top:6px;">
      <div class="field-group">
        <label>¬øCu√°ntos cigarros al d√≠a y desde hace cu√°ntos a√±os?</label>
        <input type="text" id="tabacoActualDetalle" placeholder="Ej. 5 al d√≠a desde hace 8 a√±os">
      </div>
    </div>

    <div id="tabacoDetalleEx" class="grid" style="display:none;margin-top:6px;">
      <div class="field-group">
        <label>¬øCu√°ndo dejaste de fumar y cu√°nto fumabas?</label>
        <input type="text" id="tabacoExDetalle" placeholder="Ej. Dej√© de fumar en 2020, 5 al d√≠a durante 10 a√±os">
      </div>
    </div>

    <!-- Enfermedades cr√≥nicas -->
    <div class="field-group" data-field="cronicas">
      <label>Enfermedades cr√≥nicas diagnosticadas</label>
      <div class="field-help">
        Ejemplo: diabetes, hipertensi√≥n, tiroides, colesterol alto, asma, artritis, depresi√≥n, ansiedad, etc.
      </div>
      <div class="inline-options" id="cronicasGroup" style="margin-top:4px;">
        <label class="chip"><input type="radio" name="cronicas" value="no"> <span>No, ninguno de los asegurados</span></label>
        <label class="chip"><input type="radio" name="cronicas" value="si"> <span>S√≠, al menos uno</span></label>
      </div>
      <div class="field-error">Selecciona una opci√≥n.</div>
    </div>

    <div id="cronicasDetalle" class="field-group" style="display:none;margin-top:6px;">
      <label>Indica qui√©n y qu√© diagn√≥stico(s) tiene</label>
      <textarea id="cronicasTexto" placeholder="Ej. Titular: hipertensi√≥n controlada desde 2021, hijo: asma leve."></textarea>
    </div>

    <!-- Cirug√≠as / hospitalizaciones -->
    <div class="field-group" data-field="cirugias">
      <label>Cirug√≠as, hospitalizaciones o tratamientos importantes</label>
      <div class="inline-options" id="cirugiasGroup" style="margin-top:4px;">
        <label class="chip"><input type="radio" name="cirugias" value="no"> <span>Ninguno de los asegurados</span></label>
        <label class="chip"><input type="radio" name="cirugias" value="si"> <span>S√≠, al menos uno</span></label>
      </div>
      <div class="field-error">Selecciona una opci√≥n.</div>
    </div>

    <div id="cirugiasDetalle" class="field-group" style="display:none;margin-top:6px;">
      <label>Describe brevemente (qui√©n, qu√© procedimiento, en qu√© a√±o, si qued√≥ con secuelas)</label>
      <textarea id="cirugiasTexto" placeholder="Ej. Esposa: ces√°rea en 2019 sin complicaciones. Titular: apendicectom√≠a en 2003, sin secuelas."></textarea>
    </div>

    <!-- Medicamentos -->
    <div class="field-group" data-field="medicamentos">
      <label>¬øAlguno de los asegurados toma medicamentos de forma habitual?</label>
      <div class="inline-options" id="medicamentosGroup" style="margin-top:4px;">
        <label class="chip"><input type="radio" name="medicamentos" value="no"> <span>No</span></label>
        <label class="chip"><input type="radio" name="medicamentos" value="si"> <span>S√≠</span></label>
      </div>
      <div class="field-error">Selecciona una opci√≥n.</div>
    </div>

    <div id="medicamentosDetalle" class="field-group" style="display:none;margin-top:6px;">
      <label>¬øQui√©n los toma, qu√© medicamento y por qu√© motivo?</label>
      <textarea id="medicamentosTexto" placeholder="Ej. Titular: losart√°n 50 mg diarios por hipertensi√≥n."></textarea>
    </div>

    <!-- Alergias -->
    <div class="field-group" data-field="alergias">
      <label>¬øAlg√∫n asegurado tiene alergias importantes? (medicamentos, alimentos, picaduras, etc.)</label>
      <div class="inline-options" id="alergiasGroup" style="margin-top:4px;">
        <label class="chip"><input type="radio" name="alergias" value="no"> <span>No</span></label>
        <label class="chip"><input type="radio" name="alergias" value="si"> <span>S√≠</span></label>
      </div>
      <div class="field-error">Selecciona una opci√≥n.</div>
    </div>

    <div id="alergiasDetalle" class="field-group" style="display:none;margin-top:6px;">
      <label>Describe alergias relevantes y en qui√©n</label>
      <textarea id="alergiasTexto" placeholder="Ej. Hijo: alergia a penicilina, reacci√≥n con ronchas y dificultad para respirar."></textarea>
    </div>

    <!-- Cong√©nitos / otros -->
    <div class="field-group" data-field="congenitos">
      <label>¬øSabes de alg√∫n padecimiento cong√©nito, malformaci√≥n o condici√≥n de nacimiento?</label>
      <div class="inline-options" id="congenitosGroup" style="margin-top:4px;">
        <label class="chip"><input type="radio" name="congenitos" value="no"> <span>No</span></label>
        <label class="chip"><input type="radio" name="congenitos" value="si"> <span>S√≠</span></label>
      </div>
      <div class="field-error">Selecciona una opci√≥n.</div>
    </div>

    <div id="congenitosDetalle" class="field-group" style="display:none;margin-top:6px;">
      <label>Describe brevemente qui√©n y qu√© diagn√≥stico tiene</label>
      <textarea id="congenitosTexto" placeholder="Ej. Hija: malformaci√≥n de Chiari diagnosticada en 2009, en seguimiento neurol√≥gico."></textarea>
    </div>

    <!-- Comentario libre -->
    <div class="field-group" style="margin-top:10px;">
      <label>Cu√©ntame con tus palabras algo que consideres importante sobre tu salud o la de tu familia</label>
      <textarea id="comentarioLibre" placeholder="Ej. 'En general estamos sanos, salvo lo que coment√© arriba. Actualmente hacemos chequeos anuales.'"></textarea>
      <div class="field-help">
        Aqu√≠ puedes ampliar cualquier respuesta anterior o aclarar algo que no supiste d√≥nde poner.
      </div>
    </div>
  </section>

  <!-- Secci√≥n 4: Confirmaci√≥n -->
  <section class="card" data-step-pane="4" style="display:none;">
    <h2>4. Confirmaci√≥n y env√≠o</h2>
    <p class="card-sub">
      Antes de enviarme la informaci√≥n, revisa que los datos principales est√©n correctos. Estos datos son la base
      para llenar el cuestionario m√©dico de la aseguradora.
    </p>

    <div class="field-group">
      <label>Resumen r√°pido del titular</label>
      <div id="resumenTitular" class="field-help">
        Se generar√° autom√°ticamente con base en lo que capturaste.
      </div>
    </div>

    <div class="field-group" style="margin-top:10px;">
      <label>Resumen de asegurados adicionales</label>
      <div id="resumenDependientes" class="field-help">
        Si agregaste familiares, aqu√≠ aparecer√° un listado breve.
      </div>
    </div>

    <div class="field-group" style="margin-top:12px;">
      <label>Resumen general de salud</label>
      <div id="resumenSalud" class="field-help">
        Se generar√° un resumen muy breve con tus respuestas (sin entrar en detalles cl√≠nicos extensos).
      </div>
    </div>

    <div class="field-group" style="margin-top:14px;">
      <label>Confirmaciones</label>
      <div style="font-size:12px;color:var(--muted);margin-bottom:6px;">
        Marca estas casillas para poder enviar la informaci√≥n.
      </div>
      <div style="display:flex;flex-direction:column;gap:6px;font-size:13px;">
        <label style="display:flex;align-items:flex-start;gap:6px;">
          <input type="checkbox" id="chkVeracidad" style="margin-top:2px;">
          <span>Confirmo que la informaci√≥n proporcionada es lo m√°s exacta y completa posible seg√∫n mi conocimiento actual.</span>
        </label>
        <label style="display:flex;align-items:flex-start;gap:6px;">
          <input type="checkbox" id="chkContacto" style="margin-top:2px;">
          <span>Autorizo que Christian me contacte por WhatsApp, tel√©fono o correo para revisar opciones de seguro.</span>
        </label>
      </div>
    </div>

    <div class="form-footer">
      <div class="privacy-hint">
        Tus respuestas no sustituyen el cuestionario oficial de la aseguradora, pero aceleran el proceso
        y reducen errores al momento de contratar.
      </div>
      <div>
        <button type="button" class="btn" onclick="window.print()">Descargar PDF</button>
        <button type="button" class="btn btn-primary" onclick="enviarWhatsApp()">
          Enviar a mi asesor por WhatsApp
        </button>
      </div>
    </div>
  </section>

</div>

<!-- Bot√≥n flotante WhatsApp (solo atajo para escribirte) -->
<a href="https://wa.me/526624176032" target="_blank" rel="noopener" class="wa-fab">
  <span>Escribir a Christian</span>
</a>

<script>
  const $ = id => document.getElementById(id);

  /* ---------- Utilidades ---------- */
  function calcEdadFromDateStr(dateStr){
    if(!dateStr) return '';
    const d = new Date(dateStr);
    if(isNaN(d.getTime())) return '';
    const today = new Date();
    let edad = today.getFullYear() - d.getFullYear();
    const m = today.getMonth() - d.getMonth();
    if(m < 0 || (m === 0 && today.getDate() < d.getDate())) edad--;
    return edad >= 0 ? edad : '';
  }

  function marcarPaso(step){
    document.querySelectorAll('.step-pill').forEach(p=>{
      p.classList.toggle('active', p.dataset.step === String(step));
    });
    document.querySelectorAll('[data-step-pane]').forEach(p=>{
      p.style.display = (p.getAttribute('data-step-pane') === String(step)) ? 'block' : 'none';
    });
  }

  function toggleChipGroup(groupEl, value){
    groupEl.querySelectorAll('.chip').forEach(label=>{
      const input = label.querySelector('input[type="radio"]');
      if(!input) return;
      label.classList.toggle('active', input.value === value && input.checked);
    });
  }

  /* ---------- RFC ‚Üí Fecha de nacimiento sugerida ---------- */
  $('titularRFC').addEventListener('blur', ()=>{
    const rfc = $('titularRFC').value.trim().toUpperCase();
    const re = /^[A-Z√ë&]{4}\d{6}[A-Z0-9]{3}$/;
    const wrap = document.querySelector('[data-field="titular_rfc"]');
    if(!rfc){
      wrap.classList.remove('has-error');
      return;
    }
    if(!re.test(rfc)){
      wrap.classList.add('has-error');
      return;
    }
    wrap.classList.remove('has-error');
    const yy = rfc.slice(4,6);
    const mm = rfc.slice(6,8);
    const dd = rfc.slice(8,10);
    const year2 = parseInt(yy,10);
    const currentYear = new Date().getFullYear()%100;
    const century = year2 <= currentYear ? 2000 : 1900;
    const year = century + year2;
    const dateStr = `${year.toString().padStart(4,'0')}-${mm}-${dd}`;
    if(!$('titularFecha').value){
      $('titularFecha').value = dateStr;
      $('titularEdad').value = calcEdadFromDateStr(dateStr);
    }
  });

  /* ---------- Edad autom√°tica ---------- */
  $('titularFecha').addEventListener('change', ()=>{
    $('titularEdad').value = calcEdadFromDateStr($('titularFecha').value);
  });

  ['dep1','dep2','dep3','dep4','dep5'].forEach(prefix=>{
    const el = $(prefix+'Fecha');
    if(!el) return;
    el.addEventListener('change', ()=>{
      $(prefix+'Edad').value = calcEdadFromDateStr(el.value);
    });
  });

  /* ---------- Chips (radios visuales) ---------- */
  function initChipGroup(groupId, name){
    const group = $(groupId);
    if(!group) return;
    group.addEventListener('click', e=>{
      const label = e.target.closest('.chip');
      if(!label) return;
      const input = label.querySelector('input[type="radio"]');
      if(!input) return;
      input.checked = true;
      toggleChipGroup(group, input.value);
    });
  }

  initChipGroup('sexoTitularGroup','titularSexo');
  initChipGroup('coberturaTipoGroup','coberturaTipo');
  initChipGroup('dep1SexoGroup','dep1Sexo');
  initChipGroup('dep2SexoGroup','dep2Sexo');
  initChipGroup('dep3SexoGroup','dep3Sexo');
  initChipGroup('dep4SexoGroup','dep4Sexo');
  initChipGroup('dep5SexoGroup','dep5Sexo');
  initChipGroup('tabacoGroup','tabaco');
  initChipGroup('cronicasGroup','cronicas');
  initChipGroup('cirugiasGroup','cirugias');
  initChipGroup('medicamentosGroup','medicamentos');
  initChipGroup('alergiasGroup','alergias');
  initChipGroup('congenitosGroup','congenitos');

  /* ---------- Cobertura tipo y dependientes ---------- */
  document.getElementById('coberturaTipoGroup').addEventListener('click', ()=>{
    const val = document.querySelector('input[name="coberturaTipo"]:checked')?.value || '';
    const cfg = $('dependientesConfig');
    const sec = $('dependientesSection');
    if(val === 'familia'){
      cfg.style.display = 'flex';
      sec.style.display = 'block';
    }else{
      cfg.style.display = 'none';
      sec.style.display = 'none';
    }
  });

  $('numDependientes').addEventListener('change', ()=>{
    const n = parseInt($('numDependientes').value,10) || 0;
    document.querySelectorAll('.dependiente-card').forEach(card=>{
      const idx = parseInt(card.dataset.index,10);
      card.style.display = idx <= n ? 'block' : 'none';
    });
  });

  /* ---------- Mostrar / ocultar detalles salud ---------- */
  function setToggleByRadio(name, expectedVal, targetId){
    const radios = document.querySelectorAll(`input[name="${name}"]`);
    const target = $(targetId);
    function refresh(){
      const val = document.querySelector(`input[name="${name}"]:checked`)?.value || '';
      target.style.display = (val === expectedVal) ? (target.tagName === 'DIV' ? (target.dataset.display || 'block') : 'block') : 'none';
    }
    radios.forEach(r=>r.addEventListener('change',refresh));
    refresh();
  }

  // Tabaco
  document.getElementById('tabacoGroup').addEventListener('click', ()=>{
    const val = document.querySelector('input[name="tabaco"]:checked')?.value || '';
    $('tabacoDetalleActual').style.display = (val === 'actual') ? 'grid' : 'none';
    $('tabacoDetalleEx').style.display = (val === 'ex') ? 'grid' : 'none';
  });

  // Otros
  setToggleByRadio('cronicas','si','cronicasDetalle');
  setToggleByRadio('cirugias','si','cirugiasDetalle');
  setToggleByRadio('medicamentos','si','medicamentosDetalle');
  setToggleByRadio('alergias','si','alergiasDetalle');
  setToggleByRadio('congenitos','si','congenitosDetalle');

  /* ---------- Validaci√≥n ---------- */
  function validarEmail(v){
    return /^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(v);
  }
  function validarTelefono(v){
    const digits = (v||'').replace(/\D/g,'');
    return digits.length >= 8;
  }
  function validarRFC(v){
    if(!v) return true;
    return /^[A-Z√ë&]{4}\d{6}[A-Z0-9]{3}$/.test(v);
  }

  function validarFormulario(showSummary=true){
    let ok = true;
    const summary = $('formErrorSummary');
    summary.style.display = 'none';

    document.querySelectorAll('.has-error').forEach(el=>el.classList.remove('has-error'));

    // Campos requeridos b√°sicos
    const required = document.querySelectorAll('.required');
    required.forEach(input=>{
      const wrap = input.closest('.field-group');
      if(!wrap) return;
      const val = (input.value||'').trim();
      if(!val){
        wrap.classList.add('has-error');
        ok = false;
      }
    });

    // RFC formato
    const rfc = $('titularRFC').value.trim().toUpperCase();
    if(rfc && !validarRFC(rfc)){
      document.querySelector('[data-field="titular_rfc"]').classList.add('has-error');
      ok = false;
    }

    // Email & phone
    if($('titularEmail').value && !validarEmail($('titularEmail').value.trim())){
      document.querySelector('[data-field="titular_email"]').classList.add('has-error');
      ok = false;
    }
    if($('titularTelefono').value && !validarTelefono($('titularTelefono').value.trim())){
      document.querySelector('[data-field="titular_telefono"]').classList.add('has-error');
      ok = false;
    }

    // Edad m√≠nima 18
    const edadTit = parseInt($('titularEdad').value,10);
    if(isNaN(edadTit) || edadTit < 18){
      document.querySelector('[data-field="titular_fecha"]').classList.add('has-error');
      ok = false;
    }

    // Sexo titular
    if(!document.querySelector('input[name="titularSexo"]:checked')){
      document.querySelector('[data-field="titular_sexo"]').classList.add('has-error');
      ok = false;
    }

    // Cobertura tipo y salud radios
    const radioGroups = [
      {name:'coberturaTipo', field:'cobertura_tipo'},
      {name:'cronicas', field:'cronicas'},
      {name:'cirugias', field:'cirugias'},
      {name:'medicamentos', field:'medicamentos'},
      {name:'alergias', field:'alergias'},
      {name:'congenitos', field:'congenitos'}
    ];
    radioGroups.forEach(g=>{
      if(!document.querySelector(`input[name="${g.name}"]:checked`)){
        const fg = document.querySelector(`[data-field="${g.field}"]`);
        if(fg){ fg.classList.add('has-error'); }
        ok = false;
      }
    });

    if(!ok && showSummary){
      summary.style.display = 'block';
    }
    return ok;
  }

  /* ---------- Resumenes para paso 4 ---------- */
  function construirResumenes(){
    const nombre = [ $('titularNombre').value, $('titularApellidos').value ].filter(Boolean).join(' ');
    const edad = $('titularEdad').value || '';
    const sexo = document.querySelector('input[name="titularSexo"]:checked')?.value === 'F' ? 'Mujer' :
                 document.querySelector('input[name="titularSexo"]:checked')?.value === 'M' ? 'Hombre' : '';
    const ciudad = $('titularCiudad').value || '';
    const ocupacion = $('titularOcupacion').value || '';

    $('resumenTitular').textContent =
      (nombre?nombre:'(Sin nombre)') +
      (edad?` ¬∑ ${edad} a√±os`:``) +
      (sexo?` ¬∑ ${sexo}`:``) +
      (ciudad?` ¬∑ ${ciudad}`:``) +
      (ocupacion?` ¬∑ ${ocupacion}`:``);

    // Dependientes
    const tipo = document.querySelector('input[name="coberturaTipo"]:checked')?.value || '';
    if(tipo !== 'familia'){
      $('resumenDependientes').textContent = 'Solo se considerar√° al titular para la cotizaci√≥n inicial.';
    }else{
      const n = parseInt($('numDependientes').value,10) || 0;
      if(n <= 0){
        $('resumenDependientes').textContent = 'Seleccionaste "Yo y mi familia", pero a√∫n no agregas datos de adicionales.';
      }else{
        const lines = [];
        for(let i=1;i<=n;i++){
          const nombreDep = ($(`dep${i}Nombre`)?.value||'').trim();
          const rel = ($(`dep${i}Relacion`)?.value||'').trim();
          const edadDep = ($(`dep${i}Edad`)?.value||'').trim();
          if(!nombreDep && !rel && !edadDep) continue;
          const desc = [
            nombreDep || `Adicional ${i}`,
            rel?`(${rel})`:'',
            edadDep?`¬∑ ${edadDep} a√±os`:''
          ].join(' ').trim();
          lines.push(`‚Ä¢ ${desc}`);
        }
        $('resumenDependientes').innerHTML = lines.length
          ? lines.join('<br>')
          : 'Seleccionaste familia, pero a√∫n no hay datos capturados de adicionales.';
      }
    }

    // Salud
    function labelFromRadio(name, map){
      const val = document.querySelector(`input[name="${name}"]:checked`)?.value || '';
      return map[val] || '';
    }

    const tabaco = labelFromRadio('tabaco',{
      nunca:'Nunca ha fumado',
      actual:'Actualmente fuma',
      ex:'Fum√≥ antes, actualmente no'
    });
    const cron = labelFromRadio('cronicas',{
      no:'Sin enfermedades cr√≥nicas declaradas',
      si:'Con al menos una enfermedad cr√≥nica declarada'
    });
    const cir = labelFromRadio('cirugias',{
      no:'Sin cirug√≠as u hospitalizaciones importantes',
      si:'Con cirug√≠as u hospitalizaciones relevantes'
    });
    const med = labelFromRadio('medicamentos',{
      no:'Sin medicamentos de uso habitual',
      si:'Con medicamentos de uso habitual'
    });

    const partes = [tabaco,cron,cir,med].filter(Boolean);
    $('resumenSalud').textContent = partes.length
      ? partes.join(' ¬∑ ')
      : 'A√∫n no se ha contestado por completo la secci√≥n de salud.';
  }

  /* ---------- Navegaci√≥n de pasos ---------- */
  document.querySelectorAll('.step-pill').forEach(pill=>{
    pill.addEventListener('click', ()=>{
      const step = parseInt(pill.dataset.step,10);
      // Valida lo anterior si se intenta ir adelante
      const current = parseInt(document.querySelector('.step-pill.active')?.dataset.step || '1',10);
      if(step > current){
        // validaci√≥n suave: solo si ya estamos en 1 √≥ 2
        if(current === 1 || current === 2 || current === 3){
          if(!validarFormulario(true)) return;
        }
      }
      if(step === 4){
        if(!validarFormulario(true)) return;
        construirResumenes();
      }
      marcarPaso(step);
    });
  });

  /* ---------- Env√≠o por WhatsApp ---------- */
  function construirMensajeWhatsApp(){
    const nombre = [ $('titularNombre').value, $('titularApellidos').value ].filter(Boolean).join(' ') || '(Sin nombre)';
    const edad = $('titularEdad').value || '';
    const ciudad = $('titularCiudad').value || '';
    const ocupacion = $('titularOcupacion').value || '';
    const telefono = $('titularTelefono').value || '';
    const email = $('titularEmail').value || '';

    const cobertura = document.querySelector('input[name="coberturaTipo"]:checked')?.value === 'familia'
      ? 'Titular + familia'
      : 'Solo titular';

    const nDeps = parseInt($('numDependientes').value,10) || 0;

    const tabaco = document.querySelector('input[name="tabaco"]:checked')?.value || '';
    const cronicas = document.querySelector('input[name="cronicas"]:checked')?.value || '';
    const cirugias = document.querySelector('input[name="cirugias"]:checked')?.value || '';
    const medicamentos = document.querySelector('input[name="medicamentos"]:checked')?.value || '';
    const alergias = document.querySelector('input[name="alergias"]:checked')?.value || '';
    const congenitos = document.querySelector('input[name="congenitos"]:checked')?.value || '';

    let msg = '';
    msg += 'Hola Christian, te env√≠o mi cuestionario inicial para GMM.\n\n';
    msg += '*Datos del titular:*\n';
    msg += `‚Ä¢ Nombre: ${nombre}\n`;
    if(edad) msg += `‚Ä¢ Edad: ${edad} a√±os\n`;
    if(ciudad) msg += `‚Ä¢ Ciudad: ${ciudad}\n`;
    if(ocupacion) msg += `‚Ä¢ Ocupaci√≥n: ${ocupacion}\n`;
    if(telefono) msg += `‚Ä¢ Tel√©fono: ${telefono}\n`;
    if(email) msg += `‚Ä¢ Correo: ${email}\n`;

    msg += '\n*A qui√©n deseo asegurar:*\n';
    msg += `‚Ä¢ Cobertura: ${cobertura}\n`;
    msg += `‚Ä¢ Adicionales capturados: ${nDeps}\n`;

    msg += '\n*Resumen de salud (detalle completo en el PDF):*\n';
    msg += `‚Ä¢ Tabaco: ${tabaco || 'sin especificar'}\n`;
    msg += `‚Ä¢ Enfermedades cr√≥nicas: ${cronicas || 'sin especificar'}\n`;
    msg += `‚Ä¢ Cirug√≠as / hospitalizaciones: ${cirugias || 'sin especificar'}\n`;
    msg += `‚Ä¢ Medicamentos habituales: ${medicamentos || 'sin especificar'}\n`;
    msg += `‚Ä¢ Alergias: ${alergias || 'sin especificar'}\n`;
    msg += `‚Ä¢ Padecimientos cong√©nitos: ${congenitos || 'sin especificar'}\n`;

    msg += '\nCuando puedas, revisemos juntos las opciones de seguro.\n';
    return msg;
  }

  function enviarWhatsApp(){
    if(!validarFormulario(true)) return;

    if(!$('chkVeracidad').checked){
      alert('Para enviar la informaci√≥n, marca que la informaci√≥n es lo m√°s exacta y completa posible.');
      return;
    }

    construirResumenes();

    const texto = construirMensajeWhatsApp();
    const url = 'https://wa.me/526624176032?text=' + encodeURIComponent(texto);
    window.open(url,'_blank');
  }

  window.enviarWhatsApp = enviarWhatsApp;

  /* ---------- Init ---------- */
  window.addEventListener('load', ()=>{
    marcarPaso(1);
  });
</script>
</body>
</html>
